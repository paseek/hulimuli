!function(t){"function"==typeof define&&define.amd?define("tinymce",t):t()}(function(){"use strict";var a;(a=jQuery)(document).on("click",".wpshop-blockquote",function(){a(".wpshop-blockquote").removeClass("active"),a(this).addClass("active")}),tinymce.create("tinymce.plugins.blockquote_button_plugin",{init:function(n,t){n.addButton("blockquote_btn",{title:"Добавить блок внимания",onclick:function(){var t=n.selection.getContent({format:"html"}),e=100;0===t.length&&(e=250);var o='<div class="wpshop-blockquote-icons"><span class="wpshop-blockquote wpshop-blockquote--warning" data-type="warning"></span><span class="wpshop-blockquote wpshop-blockquote--question" data-type="question"></span><span class="wpshop-blockquote wpshop-blockquote--danger" data-type="danger"></span><span class="wpshop-blockquote wpshop-blockquote--check" data-type="check"></span><span class="wpshop-blockquote wpshop-blockquote--info" data-type="info"></span><span class="wpshop-blockquote wpshop-blockquote--thumbs-up" data-type="thumbs-up"></span><span class="wpshop-blockquote wpshop-blockquote--thumbs-down" data-type="thumbs-down"></span><span class="wpshop-blockquote wpshop-blockquote--quote" data-type="quote"></span></div>';0===t.length&&(o+='<div class="wpshop-blockquote-textarea"><textarea placeholder="Введите текст">'+t+"</textarea></div>"),n.windowManager.open({title:"Вставить блок внимания",cmd:"blockquote_btn_command",html:o,height:e,buttons:[{text:"OK",subtype:"primary",onclick:function(){var t=a(".wpshop-blockquote.active").data("type"),e=n.selection.getContent({format:"html"});0===e.length&&(e=a(".wpshop-blockquote-textarea textarea").val());var o="<blockquote class='"+t+"'>"+e+"</blockquote>";n.execCommand("mceInsertContent",0,o),tinymce.activeEditor.windowManager.close()}},{text:"Отмена",onclick:"close"}]})}}),n.addButton("content_btn",{title:"Добавить кнопку",image:t+"/../images/admin/tinymce-button.png",onclick:function(){n.windowManager.open({title:"Вставить кнопку",body:[{type:"textbox",name:"text",label:"Текст кнопки"},{type:"textbox",name:"href",label:"Ссылка"},{type:"listbox",name:"hide_link",label:"Скрыть ссылку",values:[{text:"Скрыть",value:"yes"},{text:"Не скрывать",value:"no"}]},{type:"colorbox",name:"background_color",label:"Цвет фона",onaction:e()},{type:"colorbox",name:"color",label:"Цвет текста",onaction:e()},{type:"listbox",name:"size",label:"Размер",values:[{text:"Маленькая",value:"small"},{text:"Средняя",value:"normal"},{text:"Большая",value:"big"}]},{type:"listbox",name:"target",label:"Открыть ссылку",values:[{text:"В этой вкладке",value:"_self"},{text:"В новой вкладке",value:"_blank"}]}],onsubmit:function(t){var e="";0===t.data.text.length&&(t.data.text="Button"),0!==t.data.background_color.length&&(e+=' background_color="'+t.data.background_color+'"'),0!==t.data.color.length&&(e+=' color="'+t.data.color+'"'),n.insertContent('[button href="'+t.data.href+'" hide_link="'+t.data.hide_link+'" '+e+' size="'+t.data.size+'" target="'+t.data.target+'"]'+t.data.text+"[/button]")}})}}),n.addButton("spoiler_btn",{title:"Спойлер",cmd:"spoiler_btn_command",image:t+"/../images/admin/spoiler-ico.png"}),n.addButton("mark_btn",{title:"Выделить текст",image:t+"/../images/admin/tinymce-mark.png",onclick:function(){var t,e,o=n.selection.getContent({format:"html"});0!==o.length?(t="<mark>"+o+"</mark>",n.execCommand("mceInsertContent",0,t)):(e='<div class="wpshop-mark-btn-textarea"><textarea placeholder="Введите текст">'+o+"</textarea></div>",n.windowManager.open({title:"Вставить выделенный текст",cmd:"mark_btn_command",html:e,height:170,buttons:[{text:"OK",subtype:"primary",onclick:function(){var t;0!==(o=a(".wpshop-mark-btn-textarea textarea").val()).length&&(t="<mark>"+o+"</mark>",n.execCommand("mceInsertContent",0,t)),tinymce.activeEditor.windowManager.close()}},{text:"Отмена",onclick:"close"}]}))}}),n.addButton("mask_link",{title:"Замаскировать ссылку",cmd:"mask_link_command",image:t+"/../images/admin/link.png"}),n.addCommand("mask_link_command",function(t,e){var o,a=n.selection.getContent({format:"raw"});""!==a?""!==(o=jQuery.trim(prompt("Введите адрес ссылки")))?n.execCommand("mceInsertContent",0,'[mask_link href="'+o+'" target="_blank"]'+a+"[/mask_link]"):alert("Необходимо указать адрес ссылки"):alert("Необходимо выделить текст ссылки")}),n.addCommand("spoiler_btn_command",function(){var t,e,o=n.selection.getContent({format:"html"});0!==o.length?(e=' title="'+(t=prompt("Введите заголовок спойлера или оставьте пустым"))+'"',0===t.length&&(e=""),n.execCommand("mceReplaceContent",!1,"[spoiler"+e+"]"+o+"[/spoiler]")):alert("Выделите текст для спойлера")})},createControl:function(t,e){return null},getInfo:function(){return{longname:"Extra Buttons",author:"WPShop.biz",version:"1"}}}),tinymce.PluginManager.add("blockquote_button_plugin",tinymce.plugins.blockquote_button_plugin);var o=tinymce.activeEditor;function e(){var t=o.settings.color_picker_callback;if(t)return function(){var e=this;t.call(o,function(t){e.value(t).fire("change")},e.value())}}});